DO-RAG：知识图谱赋能的垂直领域智能问答系统

作者：
David Osei Opoku*（清华大学计算机系）
Ming Sheng†（清华信息国家研究中心）
Yong Zhang‡

摘要——专业领域的智能问答不仅要求回答流畅，更需要精准的专业知识支撑。现有检索增强生成（RAG）技术虽提升了信息召回能力，却难以有效整合多源异构数据并保证推理逻辑的一致性。为此，我们创新性地提出DO-RAG框架，通过知识图谱与语义检索的深度融合，打造可扩展的智能问答解决方案。该系统采用独特的智能体思维链技术，从海量非结构化文档中自动构建动态知识图谱，显著提升检索准确率。在响应生成阶段，DO-RAG巧妙融合图谱推理与向量检索结果，并引入事实校验机制有效抑制幻觉产生。在数据库和电力等专业领域的测试中，该系统实现了近乎完美的信息召回率和94%以上的答案准确率，性能最高领先基线方法33个百分点。凭借其可追溯、可扩展和高效率的特性，DO-RAG为跨领域精准问答提供了坚实的技术底座。

关键词——垂直问答、大模型、知识图谱、检索增强生成、专业知识检索

I. 引言

问答系统（QA）让用户能用自然语言从海量资料中精准获取信息，主要分为两类：开放域QA依托常识作答，封闭域QA则需专业资料支持。后者往往暴露通用模型的短板，必须注入领域知识才能输出可靠答案。

随着DeepSeek-R1、Grok 3等大语言模型（LLM）的突破，文本流畅度和语义理解显著提升。但这些模型依赖参数记忆，遇到专业术语或复杂推理时，仍可能"胡言乱语"或答非所问。

检索增强生成（RAG）通过在作答前抓取相关片段提升准确性-，知识图谱（KG）则用结构化关系网络支持多步推理。但现有方案存在明显缺陷：技术文档中的复杂关联常被割裂检索，导致答案支离破碎-；而构建高质量领域图谱费时费力，与向量搜索结合又带来巨大工程负担。

为此，我们推出DO-RAG框架，实现三大创新：
1️⃣ 智能构建动态知识图谱：通过多级智能体流水线，自动从文本、表格等多模态数据中提取实体关系
2️⃣ 双轨检索融合：结合图谱推理与语义搜索，生成信息饱满的提示模板
3️⃣ 幻觉修正机制：对照知识库校验答案，迭代修正逻辑漏洞

在数据库等专业领域测试中，DO-RAG以94%的准确率碾压主流方案，最高领先33个百分点。其模块化设计更支持即插即用，无需重训练即可迁移到新领域。

全文脉络：第二节梳理领域QA技术现状，第三节详解框架设计，第四节通过实验验证方案优势，最后探讨发展前景，第五节总结创新价值。

二、理论基础与研究现状

A. 技术原理

特定领域问答系统通过文档语料$\mathcal{D}$和知识图谱${\mathcal G}\ =\ (V,E,W)$获取答案，其中$V$为实体集，$E$为关系集，$W$为关系置信度权重。查询$q$经嵌入函数$E$映射为$d$维向量：

$$
\boldsymbol{Q}=E(\boldsymbol{q})\in\mathbb{R}^{d}
$$

文档片段$c_i$采用相同方式嵌入：

$$
C_i = E(c_i) \in \mathbb{R}^d
$$

综合检索得分$S$融合语义相似度与图谱关联性：

$$
S = \alpha \cdot \max_i \text{sim}(Q,C_i) + (1-\alpha) \cdot R(\mathcal{G}_Q)
$$

其中$\alpha$为平衡系数，$R(\mathcal{G}_Q)$从图谱中提取相关实体。最终答案由生成函数$G$产生：

$$
A = G(Q,S)
$$

系统通过最小化损失函数$\mathcal{L}$来优化模型参数$\theta$：

$$
\min_\theta \mathbb{E}_{(q,a^*)} \mathcal{L}(G(Q,S;\theta), a^*)
$$

B. 研究进展

领域问答系统历经三代演进：从早期的规则驱动，到引入知识图谱增强推理，再到当前结合检索与生成的混合架构。大型语言模型虽在通用任务表现优异，却受限于专业领域的幻觉问题。检索增强生成(RAG)技术通过锚定检索内容缓解该问题，但对技术文档的复杂关系处理仍存瓶颈。

现有方案各具局限：KIMedQA医疗精度优异但算力需求高；Panda专精数据库调试却缺乏跨领域能力；KG-RAG融合生物医学图谱但扩展性不足。为此，我们提出DO-RAG框架，创新性地实现了：
1. 动态知识图谱自动构建
2. 向量检索与知识推理深度融合
3. 领域自适应能力增强
该设计显著提升了专业问答的准确性与适用范围。

三、实现方案

A. 系统架构全景

如图1所示，DO-RAG系统由四大核心模块构成：(1)多模态文档解析与分块处理，(2)知识图谱(KG)构建中的多层级实体关系抽取，(3)图遍历与向量搜索的混合检索机制，(4)面向精准回答的多阶段生成引擎。

![](images/9b7f9493360d1377e2adff4bb70b8e423ee0fff6465897dc6bf09816f613f776.jpg)  
图1：DO-RAG技术框架总览

系统首先对日志、技术文档、图表等异构数据进行智能分块，并将文本片段与其向量化表示同步存储于pgvector增强的PostgreSQL数据库。与此同时，通过思维链驱动的智能体流程，将文档内容转化为结构化的多模态知识图谱(MMKG)，精准捕捉系统参数、行为特征等多维关联。

当用户发起查询时，意图解析模块会将其拆解为若干子查询。系统首先在知识图谱中定位相关实体节点，通过多跳推理扩展检索边界，获取富含领域特性的结构化上下文。

随后，系统运用图谱感知的提示模板对原始查询进行语义精炼，将其转化为无歧义的精准表达。优化后的查询通过向量化检索，从数据库中召回最相关的文本片段。

最终，系统融合原始查询、优化语句、图谱上下文、检索结果及对话历史，构建统一提示输入生成引擎。答案生成经历三阶段打磨：首轮生成、事实校验与语义优化、最终凝练。系统还会智能预测后续问题，实现自然流畅的多轮对话体验。

B. 知识库构建  

文档处理从多模态输入开始，文本、表格和图像经过标准化处理，分割为语义连贯的片段，同时保留源文件结构、章节层级等元数据以确保可追溯性。  

我们采用多智能体分层流水线并行抽取结构化知识。如图2所示，四个专用智能体各司其职：  
- **高层智能体**：解析文档骨架（章节/段落）  
- **中层智能体**：抓取领域实体（系统组件/API/参数）  
- **底层智能体**：挖掘细粒度操作逻辑（线程行为/错误链路）  
- **协变量智能体**：标注节点属性（默认值/性能影响）  

最终生成动态知识图谱 $\mathcal{G}=(V,E,W)$，以节点表实体、边表关联、权重表置信度。通过余弦相似度比对实体嵌入向量实现去重，并聚合相似实体为摘要节点以简化图谱。  

![](images/ac937e6af4ac894d979dbf9925cd367111cdc7597db92e536013dae44e86cb99.jpg)  
图2：多层次实体关系抽取架构

C. 混合检索与查询分解




如图3所示，当用户提问时，DO-RAG会通过基于大语言模型的意图分析器对问题进行结构化拆解，生成指导知识图谱（KG）和向量库检索的子查询。系统首先根据语义相似度从KG中提取相关节点，通过多跳遍历构建富含上下文的子图。借助图感知提示，这些图谱证据会优化查询表述并消除歧义。优化后的查询经向量化处理后，即可从向量库中获取语义相近的内容片段。最终，DO-RAG会将原始查询、优化查询、图谱上下文、向量检索结果及用户对话历史等所有信息，整合成统一的提示框架。

D. 答案的生成与交付  

如图4所示，最终答案通过分阶段提示策略生成。首先，基础提示要求大语言模型仅依据检索到的证据作答，避免无依据内容。随后通过优化提示对答案进行结构调整和验证，最后凝练阶段确保回答的语气、语言和风格与问题保持一致。  

为提升交互体验，DO-RAG还会基于优化后的答案生成后续问题。最终交付内容包括：(1) 精炼可验证的答案，(2) 标注来源的引用，(3) 针对性后续问题。若证据不足，系统会如实返回"我不知道"，确保可靠性和准确性。

四、实验验证

我们选用Client Service国际公司(CSII)研发的SunDB分布式关系数据库作为测试平台。该系统在金融、电信等关键领域广泛应用，其技术手册、系统日志和规范说明构成的异构数据集，为验证DO-RAG的多模态处理、实体关系挖掘和混合检索能力提供了理想场景。

A. 实验配置

硬件环境：64GB内存+NVIDIA A100显卡的Ubuntu工作站
软件栈：
• 追踪系统：LangFuse(v3.29.0)
• 缓存管理：Redis(v7.2.5)  
• 文档存储：MinIO(最新版)
• 分析引擎：ClickHouse(稳定版)
• 向量数据库：PostgreSQL+pgvector组合

测试数据：
1. SunDB核心数据集：含嵌入式代码的技术文档
2. 电气工程辅助集：带电路图的技术手册
每组245道专业题库均标注标准答案及精确出处

评估体系：
四大核心指标(达标线0.7分)：
1. 答案相关性(AR) - 语义匹配度
2. 上下文召回(CR) - 信息完整度  
3. 检索精度(CP) - 结果纯净度
4. 内容忠实度(F) - 答案可信度

评估工具链：
RAGAS负责指标计算，DeepEval进行端到端验证，LangFuse实现全链路追踪

对比方案：
• 横向对比：FastGPT/TiDB.AI/Dify.AI三大主流框架
• 纵向对比：知识图谱增强版vs纯向量检索版

测试方法：
统一知识库构建→多领域题库测试→三大模型(DeepSeek系列+GPT-4精简版)并行评估→综合得分计算

B. 实验结果

外部基准测试  
表I显示，在跨模型测试中，SunDB.AI的综合评分全面超越FastGPT、TiDB.AI和Dify.AI三大基线系统。图5通过可视化对比，直观呈现了SunDB.AI的持续领先优势。

（插图：图5 框架与语言模型综合评分对比）

内部优化验证  
表II揭示：集成知识图谱后，DeepSeek-V3的答案相关性提升5.7%，上下文精确度提高2.6%，双模型均实现100%上下文召回。未启用图谱时，召回率下滑至96.4%-97.7%，且因依赖非结构化搜索导致可信度降低。值得注意的是，DeepSeek-R1在启用图谱后出现5.6%的可信度微降，推测源于其创造性输出特性。

领域专项表现  
SunDB与电气领域测试数据（表III/IV）显示，各模型上下文召回率均逼近满分。答案相关性、精确度与可信度的差异化表现，折射出不同模型的特长所在。

C. 研究展望

现存挑战  
• 即便基于知识图谱，DeepSeek-R1等创意型模型仍存在幻觉风险  
• 当前单领域245问的数据规模，难以覆盖边缘案例  
• 多智能体混合检索的算力需求，制约着大规模实时部署  

演进方向  
√ 强化提示工程约束，遏制幻觉生成  
√ 构建含边缘案例的扩展数据集  
√ 研发分布式处理架构与智能缓存，优化响应速度

V. 结论

本文提出DO-RAG框架，专门针对封闭领域QA任务中现有RAG系统的不足。该框架通过智能体思维链提取流程，将多模态非结构化数据转化为动态多级知识图谱，结合图遍历与语义搜索获取结构化上下文信息。后生成阶段通过知识图谱交叉验证输出，迭代修正幻觉以提升准确性。在数据库和电气领域的测试中，DO-RAG实现近100%召回率和94%以上的答案相关性，性能超越基线框架达33.38%。结果表明，DO-RAG通过融合结构化知识表示与生成推理，能有效构建可扩展的领域专用QA系统，显著提升专业领域问答的准确性与鲁棒性。

参考文献

 DeepSeek-AI, 《Deepseek-r1：基于强化学习的LLM推理能力突破》，2025。

 xAI, 《Grok 3 beta：开启推理智能体新时代》，2025。

 Q. Team, 《Qwq：探索未知边界的深度思考》，2024。

 OpenAI, 《O3与O4 mini：新一代模型发布》，2024。

 Z. Yang等, 《CuriousLLM：知识图谱推理赋能多文档问答》，NAACL 2025。

 Q. Zhou等, 《基于LLM的用户故事自动化测试用例生成》，SEKE 2024。

 S. Siriwardhana等, 《开放领域问答中RAG模型的领域适应优化》，《计算语言学协会会刊》11卷，2023。

 Z. Huang等, 《开放领域文本问答系统的深度学习进展》，《IEEE Access》8卷，2020。

 K. Bhushan等, 《领域专用RAG的知识注入方法》，NAACL 2025。

 Z. Zhang等, 《基于CLIP机制的领域问答算法》，《计算机与通信杂志》11卷，2023。

 A. Tu等, 《LightProf：知识图谱上的轻量级LLM推理框架》，AAAI 2025。

表II：知识图谱对DeepSeek模型的影响分析

![](images/e4c7e895ac35c76adef1d044a9db2afbf6472199d10843ef8e522a86436983f9.jpg)

表III：数据库领域LLM性能对比

![](images/fa50d7a46cd30cc555cc0d6dfd3f22436ac30cd84ad1c84bc456e5a170e2a279.jpg)

表IV：电气领域LLM性能对比

![](images/501202af6db97b439cdb362c39a7d204e799b90c801a29f8bfe257f0c5280c89.jpg)

![](images/867054525be2d91dff25882b3ddfb5c1f7fa6e9c4159422d1a14942f8d968302.jpg)

 Y. Wang等, 《知识图谱提示在多文档问答中的应用》，AAAI 2024。

 A. Zafar等, 《KimedQA：医学知识增强问答系统》，《智能信息系统杂志》2024。

 A. Dagnino, 《IIoT企业AI系统中数据质量的重要性》，SEKE 2024。

 Labring, 《FastGPT：专家知识驱动的AI平台》，2025。

 P. Inc., 《TiDB.ai：开源GraphRAG知识库》，2024。

 D. Contributors, 《Dify.ai：开源LLM应用开发平台》，2023。

 A. Allam等, 《受限领域问答系统综述》，《计算语言学》33卷，2012。

 E. Dimitrakis等, 《链接数据与文档问答系统研究进展》，《智能信息系统杂志》55卷，2020。

 K. Singhal等, 《LLM编码临床知识研究》，《自然》620卷，2023。

 P. Lewis等, 《知识密集型NLP任务的检索增强生成》，NeurIPS 2020。

 X. Zhu等, 《知识图谱引导的检索增强生成》，NAACL 2025。

 V. Singh等, 《Panda：LLM智能体驱动的数据库调试工具》，CIDR 2024。

 K. Soman等, 《生物医学知识图谱增强的提示生成》，arXiv 2023。

 L. Team, 《Langfuse：LLM应用观测平台》v3.29.0，2025。

 Redis Ltd., 《Redis》v7.2.5，2025。

 MinIO, 《MinIO：高性能对象存储》2025版。

 ClickHouse, 《ClickHouse：开源列式数据库》v25.4，2025。

 PostgreSQL v16.4，2025。

 Ragas开发者, 《Ragas文档》，2023。

 DeepSeek-AI等, 《Deepseek-v3技术报告》，arXiv 2024。

 OpenAI, 《GPT-4o mini：高性价比智能模型》，2024。