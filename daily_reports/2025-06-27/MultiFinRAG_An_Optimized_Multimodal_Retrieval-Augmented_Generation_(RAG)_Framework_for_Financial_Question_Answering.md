# 金融文档问答革命：Multi Fin RAG如何用3大创新击败ChatGPT-4o？
发布时间：2025年06月25日

`RAG`

![](https://raw.githubusercontent.com/HuggingAGI/wx_assets/main/2025/02/12/1739367812022-81912e8f-5f91-4b9d-b4b2-52b0e322d137.png)
**添加请注明[]**

**如遇无法添加，请+ vx: iamxxn886**

<hr />



## 一、为什么需要专门的多模态金融问答技术？

### 1.1 金融文档的独特挑战
现代金融文件（如10-K年报、10-Q季报）平均超过120页，包含275+表格和200+图表。传统检索增强生成（Retrieval-Augmented Generation, RAG）系统面临三大痛点：文本碎片化导致上下文断裂、表格图表被当作普通文本处理、静态检索返回冗余信息。论文作者团队发现，当问题需要结合文本描述和表格数据时，传统方法的准确率骤降40%。

以摩根士丹利10-Q文件为例，关键财务指标"管理风险值(VaR)"的说明常被分割在不同文本分块中。这种碎片化使得系统无法完整理解风险值的计算逻辑。更严重的是，当表格被强制转换为纯文本时，会丢失行列关系，导致"比较Q1和Q2毛利率变化"这类需要跨表格单元格对比的问题无法回答。实验数据显示，传统方法处理这类跨单元格查询的准确率不足35%。

### 1.2 现有解决方案的局限性
主流RAG系统采用固定大小的文本分块策略（通常512-1024个token），这会割裂完整的财务分析段落。例如在审计报告中，关键假设说明可能跨越多个分块，导致系统只能捕获部分信息。论文测试发现，当问题涉及分布在3个以上分块的内容时，回答准确率下降达62%。

表格处理方面，现有方法存在双重缺陷：一是将HTML表格转换为Markdown时会丢失样式信息，二是OCR识别表格时行列对齐错误率高达28%。这使得像"找出负债表中流动比率最高的子公司"这类需要精确表格解析的问题难以处理。作者团队在实验中观察到，传统方法对包含合并单元格的复杂表格解析准确率仅为41%。

### 1.3 跨模态推理的行业需求
审计和投资决策中47%的问题需要同时引用文本叙述和数字表格。典型案例包括：先通过文本确定"装饰产品线"对应表格中的"Decor"分类，再提取具体数值。这种跨模态推理需求催生了Multi Fin RAG的三大创新设计。

在压力测试中，需要结合文本定义和表格数据的复合问题占比达34%，但现有系统处理这类问题的平均响应时间超过45秒，且准确率不足50%。这促使研究者开发了模态感知检索技术，通过设置文本(θ=0.70)、表格(θ=0.65)、图像(θ=0.55)的差异化相似度阈值，将跨模态查询准确率提升至75.3%。




## 2.1 核心技术三件套

Multi Fin RAG框架通过三个核心技术组件实现了金融文档的智能问答，这些技术共同解决了传统RAG系统在处理多模态金融文档时的关键痛点。

**批量多模态提取**是该系统的第一个创新点。研究人员采用量化版的Gemma3-12B模型（内存占用减少65%），将PDF文档中的表格和图表批量转换为结构化JSON和文本摘要。这种处理方式类似于将复杂的财务报表"翻译"成机器可读的格式，就像把Excel表格转换成数据库记录。例如，在处理摩根士丹利的10-Q报表时，系统可以一次性处理10-15个表格图像，输出包含数值关系的结构化数据，同时生成3-6句关键描述。

**语义分块合并**技术解决了文档碎片化问题。传统RAG系统使用固定大小的文本块，常常会割裂完整的语义单元。Multi Fin RAG通过计算句子嵌入的余弦相似度（阈值>0.85），将相关的内容重新组合。这就像把打散的拼图重新拼合——系统首先将文档分割成句子，然后通过滑动窗口计算相邻句子的语义距离，在语义转折点进行分割，最后合并相似的内容块。这种方法使检索到的上下文更加连贯，减少了40-60%的冗余信息。

**分级回退策略**是系统的智能检索机制。当用户提出问题时，系统首先在纯文本索引中检索（相似度阈值θ=0.70）；如果结果不足6条，会自动扩展到表格内容（θ=0.65）；仍不足时再补充图像上下文（θ=0.55）。这种渐进式的检索方式就像图书馆的搜索系统——先找最相关的书籍，不够时再查阅附录表格，最后参考插图资料。测试表明，这种策略在保持精度的同时显著提高了复杂问题的回答准确率。

## 2.2 轻量级处理流水线

系统采用模块化设计实现高效的多模态处理，所有组件都可在消费级硬件上运行。

**文本处理**流程使用BAAI/bge-base-en-v1.5模型生成嵌入向量。这个开源的句子转换器（Sentence Transformer）专门为英文语义搜索优化，能够准确捕捉金融术语的细微差别。在处理Home Depot公司的10-Q文件时，它能正确识别"accrual status"（应计状态）等专业术语的上下文含义。

**表格解析**环节结合了计算机视觉和语言模型。首先用Detectron2（基于TableBank数据集预训练）检测表格区域，然后批量输入Gemma3模型进行解析。例如，系统可以将摩根士丹利资产负债表的图像转换为包含"restricted cash: $29,904 million"等字段的JSON结构，保留原始表格的行列关系。

**图像摘要**模块会智能过滤非数据元素。当处理包含水印或公司logo的图表时，系统会忽略这些装饰性内容，专注于提取数据特征。比如对某季度VaR（风险价值）曲线图，模型会生成"95%置信度的单日VaR峰值在50-55百万美元之间"这样的关键描述，而不是简单复述图表的标题。

## 2.3 动态阈值检索机制

系统为不同类型的内容设置了最优相似度阈值，实现精准的上下文筛选。

**文本检索**采用较高的阈值（θ=0.70），确保返回的内容高度相关。例如查询"weak US dollar impact"时，只有包含具体数值（如"$106 million"）的句子才会被选中，避免返回泛泛而谈的段落。

**表格检索**使用中等阈值（θ=0.65），在数值准确性和召回率之间取得平衡。当查询"restricted cash amount"时，系统会放宽标准以捕捉不同表述方式（如"受限现金"或"限制性资金"）的表格内容。

**图像检索**阈值最低（θ=0.55），扩大视觉信息的覆盖范围。因为图表信息通常分布在不同元素中，较低阈值可以确保包含相关数据点的多个图表片段都能被检索到。例如查询"VaR peak range"时，即使图表描述中没有完全匹配的短语，但只要包含相关数据区间就会被纳入。

这种动态机制通过实验校准得出：研究人员在保留数据集上测试了从0.55到0.85的不同阈值组合，最终选择在保持上下文质量的同时最大化QA准确率的参数。当文本检索结果不足时，系统会自动触发4条表格和3条图像的补充检索，形成完整的跨模态证据链。




## 三、实际效果如何碾压传统方案？

### 3.1 四类问题全面评测

在300个测试问题中，Multi Fin RAG展现出显著优势。对于纯文本问题，其准确率达到90.4%，比ChatGPT-4o高出4.1个百分点。这个差距看似不大，但在金融领域，即使是1%的准确率提升也可能带来重大影响。例如在处理"HTM证券投资组合中投资级证券占比"问题时，ChatGPT-4o错误回答"100%"，而Multi Fin RAG准确捕捉到文档中"98%"的关键数据。

图像解析问题的表现差异更为惊人。Multi Fin RAG以66.7%的准确率领先ChatGPT-4o达40个百分点。典型案例是解析摩根士丹利VaR图表时，ChatGPT-4o将"$50-55百万"误读为"$63-98百万"，这是因为传统方法无法有效隔离文本中的干扰数字。而Multi Fin RAG通过模态感知检索，准确锁定图表数据区间。

表格查询方面，69.4%的准确率相比基准提升25%。当询问"摩根士丹利2025年3月31日的限制性现金金额"时，ChatGPT-4o错误回答"0百万"，而Multi Fin RAG正确提取表格中的"29,904"数值。最复杂的跨模态复合问题（需同时处理文本和图表）中，40%的准确率仍比基准高出19.3%。

### 3.2 典型错误案例分析

传统方案的失败案例揭示了多模态处理的瓶颈。以摩根士丹利VaR图表解析为例，ChatGPT-4o的错误源于两个关键缺陷：首先，它将整个文档作为扁平化文本处理，无法区分图表数据与周边文本；其次，缺乏专门的视觉理解模块，导致将图表旁注的无关数字误认为答案。

相比之下，Multi Fin RAG的模态感知检索机制像金融分析师一样工作：先通过Detectron2定位图表区域，再用Gemma3生成结构化描述，最后通过65%的相似度阈值筛选相关上下文。这种分阶段处理确保数值精确性，避免"数字污染"问题。

表格查询错误同样具有启发性。ChatGPT-4o声称"文件中明确说明限制性现金为0"，实际上这是训练数据偏差导致的幻觉。Multi Fin RAG则严格遵循检索-验证流程：先定位"现金及现金等价物"表格，提取JSON结构化数据，再交叉验证文本描述，确保答案完全基于当前文档。

### 3.3 成本效益双赢

在Google Colab T4 GPU上，Multi Fin RAG处理200页PDF（含200表格+150图像）仅需25分钟，展现出色的工程优化。相比商用API方案实现三重突破：

首先，令牌用量减少60%。通过语义块合并技术，将相似度85%以上的文本块自动聚合，避免冗余处理。例如10-K文件中的"风险因素"章节，传统方法可能拆分为20个片段，而Multi Fin RAG合并为5-8个语义单元。

其次，准确率提升19个百分点。这源于多模态协同：当文本检索不足时，系统自动触发表格/图像回退机制。例如查询"照明产品线净销售额"时，先检索到"装饰"产品线的文本描述，再关联表格中的"12,344"数值，实现跨模态推理。

最后，完全基于Gemma3、FAISS等开源模型，实现零成本部署。虽然论文代码未公开，但技术栈均可在HuggingFace获取。这种设计特别适合金融机构，可在本地环境处理敏感数据，避免API传输风险。例如某投行测试显示，在RTX 4090显卡上即可流畅运行，年节省API费用超$50万。

这种性能突破来自三大创新：批处理多模态提取（8-10个图表/次）、动态阈值检索（文本70%、表格65%、图像55%）、以及分级回退策略。它们共同构成一个高效精准的金融文档处理引擎，在保持开源经济性的同时，提供超越商业API的专业能力。



<hr />

- 论文原文: [https://arxiv.org/abs/2506.20821](https://arxiv.org/abs/2506.20821)
- 获取更多最新Arxiv论文更新: [https://github.com/HuggingAGI/HuggingArxiv](https://github.com/HuggingAGI/HuggingArxiv)!
- 加入社群，+v: iamxxn886
- 点击公众号菜单加入讨论
![](https://raw.githubusercontent.com/HuggingAGI/wx_assets/main/2024/07/31/1722434818326-94339e92-22f1-4472-9d27-fed232f70b5d.jpeg)