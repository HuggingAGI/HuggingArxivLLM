# RefPentester: 基于大型语言模型的知识增强型自省渗透测试框架

发布时间：2025年05月11日

`LLM应用

这篇论文探讨了大型语言模型在自动化渗透测试中的应用，提出了一种新的框架来提升其性能和效果。因此，它属于LLM应用类别。` `网络安全` `信息安全`

> RefPentester: A Knowledge-Informed Self-Reflective Penetration Testing Framework Based on Large Language Models

# 摘要

> 基于大型语言模型（LLMs）的自动化渗透测试（AutoPT）因其能力而备受关注，它能够利用LLMs的内在知识自动化道德黑客流程并识别目标系统的漏洞。然而，与人类专家相比，现有的基于LLMs的AutoPT框架在处理复杂任务时往往表现不佳，原因包括：LLM训练中使用的知识不平衡、规划过程中的短视规划以及命令生成过程中的幻觉现象。此外，渗透测试（PT）过程因其试错性质，受限于现有框架缺乏从先前失败操作中学习的机制，限制了PT策略的自适应改进。为了解决这些问题，我们提出了一种基于LLMs的知识增强的自反思PT框架，名为RefPentester。它是一个AutoPT框架，旨在协助人类操作员识别PT过程的当前阶段、为该阶段选择合适的策略和方法、选择建议的操作、提供逐步操作指导以及从先前失败操作中学习。我们还将PT过程建模为一个包含七个状态的阶段机，以有效整合所提出的框架。评估结果显示，RefPentester成功揭示了Hack The Box的Sau机器上的凭证，比基线GPT-4o模型高出16.7%。在PT阶段中，RefPentester在PT阶段转换方面也表现出更高的成功率。

> Automated penetration testing (AutoPT) powered by large language models (LLMs) has gained attention for its ability to automate ethical hacking processes and identify vulnerabilities in target systems by leveraging the intrinsic knowledge of LLMs. However, existing LLM-based AutoPT frameworks often underperform compared to human experts in challenging tasks for several reasons: the imbalanced knowledge used in LLM training, short-sighted planning in the planning process, and hallucinations during command generation. In addition, the penetration testing (PT) process, with its trial-and-error nature, is limited by existing frameworks that lack mechanisms to learn from previous failed operations, restricting adaptive improvement of PT strategies. To address these limitations, we propose a knowledge-informed self-reflective PT framework powered by LLMs, called RefPentester, which is an AutoPT framework designed to assist human operators in identifying the current stage of the PT process, selecting appropriate tactic and technique for the stage, choosing suggested action, providing step-by-step operational guidance, and learning from previous failed operations. We also modeled the PT process as a seven-state Stage Machine to integrate the proposed framework effectively. The evaluation shows that RefPentester can successfully reveal credentials on Hack The Box's Sau machine, outperforming the baseline GPT-4o model by 16.7\%. Across PT stages, RefPentester also demonstrates superior success rates on PT stage transitions.

[Arxiv](https://arxiv.org/abs/2505.07089)