# # MARVEL：利用大型语言模型进行多智能体 RTL 漏洞提取

发布时间：2025年05月17日

`Agent` `硬件安全` `硬件设计`

> MARVEL: Multi-Agent RTL Vulnerability Extraction using Large Language Models

# 摘要

> 硬件安全验证是一项复杂且耗时的任务。设计工程师通常会结合形式验证、linters 和功能仿真测试等工具，以及对硬件设计的深入理解来完成这一过程。我们提出了一个创新的解决方案——MARVEL，这是一个多智能体 LLM 框架，旨在通过统一的决策、工具使用和推理方法提升硬件安全验证的效率和效果。

MARVEL 模拟了设计人员在 RTL 代码中寻找安全漏洞的思考过程。它由一个监督智能体和多个执行智能体组成。监督智能体基于系统的安全文档制定 SoCs 的安全策略，并将具体任务分配给各个执行智能体。每个执行智能体根据特定策略执行任务，可能使用一种或多种工具来识别设计中的潜在安全漏洞，并将结果返回监督智能体进行进一步分析和确认。

MARVEL 的执行智能体集成了多种工具和技术，包括形式工具、linters、仿真测试、基于 LLM 的检测方案和基于静态分析的检查。我们在基于 Hack@DATE 竞赛中 OpenTitan 的已知有缺陷的 SoC 上测试了 MARVEL。实验结果表明，MARVEL 报告的 48 个问题中有 20 个是实际的安全漏洞。


> Hardware security verification is a challenging and time-consuming task. For this purpose, design engineers may utilize tools such as formal verification, linters, and functional simulation tests, coupled with analysis and a deep understanding of the hardware design being inspected. Large Language Models (LLMs) have been used to assist during this task, either directly or in conjunction with existing tools. We improve the state of the art by proposing MARVEL, a multi-agent LLM framework for a unified approach to decision-making, tool use, and reasoning. MARVEL mimics the cognitive process of a designer looking for security vulnerabilities in RTL code. It consists of a supervisor agent that devises the security policy of the system-on-chips (SoCs) using its security documentation. It delegates tasks to validate the security policy to individual executor agents. Each executor agent carries out its assigned task using a particular strategy. Each executor agent may use one or more tools to identify potential security bugs in the design and send the results back to the supervisor agent for further analysis and confirmation. MARVEL includes executor agents that leverage formal tools, linters, simulation tests, LLM-based detection schemes, and static analysis-based checks. We test our approach on a known buggy SoC based on OpenTitan from the Hack@DATE competition. We find that 20 of the 48 issues reported by MARVEL pose security vulnerabilities.

[Arxiv](https://arxiv.org/abs/2505.11963)