# MARVEL：利用大型语言模型的多智能体RTL漏洞提取

发布时间：2025年05月17日

`Agent`

> MARVEL: Multi-Agent RTL Vulnerability Extraction using Large Language Models

# 摘要

> 硬件安全验证是一项具有挑战性且耗时的任务。设计工程师可能会使用形式验证、代码检查工具和功能仿真测试等工具，并结合对被检验硬件设计的深入分析和理解来应对这一挑战。大型语言模型（LLMs）已被用于在这一任务中提供辅助，无论是直接应用还是与现有工具结合使用。我们通过提出MARVEL（一个多智能体LLM框架）来提升现有技术水平，该框架旨在统一决策、工具使用和推理过程。MARVEL模拟了设计人员在RTL代码中寻找安全漏洞的认知过程。它包含一个监督智能体，该智能体根据系统的安全文档制定片上系统（SoCs）的安全策略，并将验证安全策略的任务分配给各个执行智能体。每个执行智能体根据其分配的任务采用特定策略执行。每个执行智能体可能会使用一种或多种工具来识别设计中的潜在安全漏洞，并将结果返回给监督智能体进行进一步分析和确认。MARVEL的执行智能体利用了形式化工具、代码检查工具、仿真测试、基于LLM的检测方案以及基于静态分析的检查。我们在来自Hack@DATE竞赛的OpenTitan开源SoC上测试了我们的方法，发现MARVEL报告的48个问题中有20个确实存在安全漏洞。

> Hardware security verification is a challenging and time-consuming task. For this purpose, design engineers may utilize tools such as formal verification, linters, and functional simulation tests, coupled with analysis and a deep understanding of the hardware design being inspected. Large Language Models (LLMs) have been used to assist during this task, either directly or in conjunction with existing tools. We improve the state of the art by proposing MARVEL, a multi-agent LLM framework for a unified approach to decision-making, tool use, and reasoning. MARVEL mimics the cognitive process of a designer looking for security vulnerabilities in RTL code. It consists of a supervisor agent that devises the security policy of the system-on-chips (SoCs) using its security documentation. It delegates tasks to validate the security policy to individual executor agents. Each executor agent carries out its assigned task using a particular strategy. Each executor agent may use one or more tools to identify potential security bugs in the design and send the results back to the supervisor agent for further analysis and confirmation. MARVEL includes executor agents that leverage formal tools, linters, simulation tests, LLM-based detection schemes, and static analysis-based checks. We test our approach on a known buggy SoC based on OpenTitan from the Hack@DATE competition. We find that 20 of the 48 issues reported by MARVEL pose security vulnerabilities.

[Arxiv](https://arxiv.org/abs/2505.11963)