# LPASS：利用压缩大型语言模型，以线性探针为垫脚石检测漏洞

发布时间：2025年05月30日

`LLM应用` `网络安全` `漏洞检测`

> LPASS: Linear Probes as Stepping Stones for vulnerability detection using compressed LLMs

# 摘要

> 大型语言模型（LLMs）在网络安全领域发挥着重要作用，特别是在漏洞代码检测方面。为了提升效率和效果，压缩和微调技术应运而生。然而，这些方法需要投入大量计算资源。我们研究了如何利用线性探针（LPs）在微调前的早期阶段评估压缩LLM的性能，并展示了它们在层剪枝压缩中设置截止点的适用性。我们的方法$LPASS$在BERT和Gemma上用于检测MITRE Top 25中最危险的12种漏洞，处理了48万个C/C++样本。线性探针的计算时间为142.97秒，发现了两个关键点：（1）分别可以移除33.3%和72.2%的层数，而不会影响精度；（2）它们能够对微调和压缩后的模型效果进行早期预测，最低和平均精度误差分别为3%和8.68%。基于$LPASS$的LLMs在多类漏洞检测中表现优异，准确率达到86.9%。更有趣的是，基于$LPASS$的Gemma压缩版本在F1分数上比原始版本高出1.6%，同时节省了29.4%和23.8%的训练和推理时间，以及42.98%的模型大小。

> Large Language Models (LLMs) are being extensively used for cybersecurity purposes. One of them is the detection of vulnerable codes. For the sake of efficiency and effectiveness, compression and fine-tuning techniques are being developed, respectively. However, they involve spending substantial computational efforts. In this vein, we analyse how Linear Probes (LPs) can be used to provide an estimation on the performance of a compressed LLM at an early phase -- before fine-tuning. We also show their suitability to set the cut-off point when applying layer pruning compression. Our approach, dubbed $LPASS$, is applied in BERT and Gemma for the detection of 12 of MITRE's Top 25 most dangerous vulnerabilities on 480k C/C++ samples. LPs can be computed in 142.97 s. and provide key findings: (1) 33.3 \% and 72.2\% of layers can be removed, respectively, with no precision loss; (2) they provide an early estimate of the post-fine-tuning and post-compression model effectiveness, with 3\% and 8.68\% as the lowest and average precision errors, respectively. $LPASS$-based LLMs outperform the state of the art, reaching 86.9\% of accuracy in multi-class vulnerability detection. Interestingly, $LPASS$-based compressed versions of Gemma outperform the original ones by 1.6\% of F1-score at a maximum while saving 29.4 \% and 23.8\% of training and inference time and 42.98\% of model size.

[Arxiv](https://arxiv.org/abs/2505.24451)