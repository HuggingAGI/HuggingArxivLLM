# HAKES: 专为嵌入式搜索服务打造的可扩展向量数据库

发布时间：2025年05月18日

`LLM应用` `数据库` `机器学习`

> HAKES: Scalable Vector Database for Embedding Search Service

# 摘要

> 现代深度学习模型通过将复杂数据转化为高维嵌入向量来捕捉其语义。新兴应用如增强生成，利用嵌入向量空间中的近似最近邻（ANN）搜索来查找相似数据。现有向量数据库为高效的 ANN 搜索提供了索引，其中基于图的索引最受欢迎，因其在现实高维数据集中的低延迟和高召回率。然而，这些索引构建成本高昂，在并发读写负载下受显著争用影响，并且在扩展到多台服务器时表现不佳。

我们的目标是打造一个在并发读写负载下实现高吞吐量和高召回率的向量数据库。为此，我们提出了一个两阶段设计的 ANN 索引，结合了使用高度压缩向量的快速过滤阶段和确保召回率的细化阶段，并设计了一种轻量级机器学习技术来优化索引参数。我们引入了动态搜索终止检查，以适应每个查询的特性。通过解耦学习参数的管理，我们支持写入操作同时保持搜索性能。最后，我们设计了 HAKES，一个分布式向量数据库，在分散式架构中提供新的索引。

我们使用深度学习模型生成的高维嵌入数据集，将我们的索引和系统与 12 个最先进的索引和三个分布式向量数据库进行了对比。实验结果表明，我们的索引在高召回率区域和并发读写负载下表现更优。此外，
amesys{} 具有良好的扩展性，吞吐量比基线高出【数学公式】倍。HAKES 项目已在 https://www.comp.nus.edu.sg/~dbsystem/hakes/ 开源。

> Modern deep learning models capture the semantics of complex data by transforming them into high-dimensional embedding vectors. Emerging applications, such as retrieval-augmented generation, use approximate nearest neighbor (ANN) search in the embedding vector space to find similar data. Existing vector databases provide indexes for efficient ANN searches, with graph-based indexes being the most popular due to their low latency and high recall in real-world high-dimensional datasets. However, these indexes are costly to build, suffer from significant contention under concurrent read-write workloads, and scale poorly to multiple servers.
  Our goal is to build a vector database that achieves high throughput and high recall under concurrent read-write workloads. To this end, we first propose an ANN index with an explicit two-stage design combining a fast filter stage with highly compressed vectors and a refine stage to ensure recall, and we devise a novel lightweight machine learning technique to fine-tune the index parameters. We introduce an early termination check to dynamically adapt the search process for each query. Next, we add support for writes while maintaining search performance by decoupling the management of the learned parameters. Finally, we design HAKES, a distributed vector database that serves the new index in a disaggregated architecture. We evaluate our index and system against 12 state-of-the-art indexes and three distributed vector databases, using high-dimensional embedding datasets generated by deep learning models. The experimental results show that our index outperforms index baselines in the high recall region and under concurrent read-write workloads. Furthermore, \namesys{} is scalable and achieves up to $16\times$ higher throughputs than the baselines. The HAKES project is open-sourced at https://www.comp.nus.edu.sg/~dbsystem/hakes/.

[Arxiv](https://arxiv.org/abs/2505.12524)