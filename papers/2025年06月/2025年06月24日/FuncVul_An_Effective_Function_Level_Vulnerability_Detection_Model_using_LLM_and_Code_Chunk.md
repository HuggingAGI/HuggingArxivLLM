# FuncVul：基于LLM和代码块的高效函数级漏洞检测模型

发布时间：2025年06月24日

`LLM应用` `网络安全` `信息安全`

> FuncVul: An Effective Function Level Vulnerability Detection Model using LLM and Code Chunk

# 摘要

> 软件供应链漏洞的产生源于攻击者利用软件仓库中广泛使用的包或库中的弱点，通过注入易受攻击的代码。然而，现有的大多数方法主要关注识别有漏洞的包或库，却忽视了具体导致漏洞的函数。在包或库中定位易受攻击的函数至关重要，因为它可以显著降低使用开源软件的风险。识别漏洞补丁颇具挑战性，因为开发人员经常提交与漏洞修复无关的代码更改。为了解决这一问题，本文引入了FuncVul，这是一种基于代码片段的创新模型，专注于C/C++和Python中的函数级漏洞检测，通过关注较小但关键的代码段来识别函数内的多个漏洞。为了评估模型的效果，我们使用两种方法构建了六个代码和通用代码片段数据集：(1) 将补丁信息与大型语言模型结合以标记有漏洞的样本；(2) 仅利用大型语言模型来检测函数级代码中的漏洞。在设计FuncVul漏洞模型时，我们采用了GraphCodeBERT微调模型，该模型能够捕捉代码的句法和语义特征。实验结果表明，FuncVul在所有数据集上平均准确率达到87-92%，F1分数达到86-92%，显著优于现有的最先进模型。此外，我们还证明，与基于整个函数的漏洞预测相比，我们的基于代码片段的FuncVul模型在准确率上提高了53.9%，F1分数提高了42.0%。FuncVul的代码和数据集在GitHub上公开可用，地址为https://github.com/sajalhalder/FuncVul。

> Software supply chain vulnerabilities arise when attackers exploit weaknesses by injecting vulnerable code into widely used packages or libraries within software repositories. While most existing approaches focus on identifying vulnerable packages or libraries, they often overlook the specific functions responsible for these vulnerabilities. Pinpointing vulnerable functions within packages or libraries is critical, as it can significantly reduce the risks associated with using open-source software. Identifying vulnerable patches is challenging because developers often submit code changes that are unrelated to vulnerability fixes. To address this issue, this paper introduces FuncVul, an innovative code chunk-based model for function-level vulnerability detection in C/C++ and Python, designed to identify multiple vulnerabilities within a function by focusing on smaller, critical code segments. To assess the model's effectiveness, we construct six code and generic code chunk based datasets using two approaches: (1) integrating patch information with large language models to label vulnerable samples and (2) leveraging large language models alone to detect vulnerabilities in function-level code. To design FuncVul vulnerability model, we utilise GraphCodeBERT fine tune model that captures both the syntactic and semantic aspects of code. Experimental results show that FuncVul outperforms existing state-of-the-art models, achieving an average accuracy of 87-92% and an F1 score of 86-92% across all datasets. Furthermore, we have demonstrated that our code-chunk-based FuncVul model improves 53.9% accuracy and 42.0% F1-score than the full function-based vulnerability prediction. The FuncVul code and datasets are publicly available on GitHub at https://github.com/sajalhalder/FuncVul.

[Arxiv](https://arxiv.org/abs/2506.19453)