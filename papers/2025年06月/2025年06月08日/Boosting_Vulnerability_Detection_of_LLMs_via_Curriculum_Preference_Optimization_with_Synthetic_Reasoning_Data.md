# # 利用合成推理数据优化课程偏好，提升大型语言模型的漏洞检测能力

发布时间：2025年06月08日

`LLM应用` `软件工程` `人工智能`

> Boosting Vulnerability Detection of LLMs via Curriculum Preference Optimization with Synthetic Reasoning Data

# 摘要

> 大型语言模型（LLMs）在编码任务中表现优异，但在软件漏洞检测方面仍显不足。这一局限主要源于两点：缺乏漏洞相关推理数据，导致模型难以识别潜在漏洞模式；以及模型专注于语义表示而非逻辑推理，因而无法有效识别语义相似的漏洞样本。此外，开发专门用于漏洞检测的LLM面临诸多挑战，尤其是在高质量数据稀缺的环境下。本文提出了一种名为ReVD的新颖框架，通过推理数据合成和漏洞特定偏好优化，显著提升了漏洞模式挖掘能力。具体而言，我们为漏洞及其修复代码设计了正向和反向推理流程，生成高质量推理数据。同时，采用三元组监督微调结合课程在线偏好优化，帮助ReVD更深入地理解漏洞特征。在PrimeVul和SVEN数据集上的实验表明，ReVD在基于LLM的漏洞检测中树立了新标杆，准确率提升达12.24%-22.77%。更多细节请访问https://github.com/Xin-Cheng-Wen/PO4Vul。

> Large language models (LLMs) demonstrate considerable proficiency in numerous coding-related tasks; however, their capabilities in detecting software vulnerabilities remain limited. This limitation primarily stems from two factors: (1) the absence of reasoning data related to vulnerabilities, which hinders the models' ability to capture underlying vulnerability patterns; and (2) their focus on learning semantic representations rather than the reason behind them, thus failing to recognize semantically similar vulnerability samples. Furthermore, the development of LLMs specialized in vulnerability detection is challenging, particularly in environments characterized by the scarcity of high-quality datasets. In this paper, we propose a novel framework ReVD that excels at mining vulnerability patterns through reasoning data synthesizing and vulnerability-specific preference optimization. Specifically, we construct forward and backward reasoning processes for vulnerability and corresponding fixed code, ensuring the synthesis of high-quality reasoning data. Moreover, we design the triplet supervised fine-tuning followed by curriculum online preference optimization for enabling ReVD to better understand vulnerability patterns. The extensive experiments conducted on PrimeVul and SVEN datasets demonstrate that ReVD sets new state-of-the-art for LLM-based software vulnerability detection, e.g., 12.24\%-22.77\% improvement in the accuracy. The source code and data are available at https://github.com/Xin-Cheng-Wen/PO4Vul.

[Arxiv](https://arxiv.org/abs/2506.07390)