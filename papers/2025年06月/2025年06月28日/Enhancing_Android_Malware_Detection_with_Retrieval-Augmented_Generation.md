# # 基于检索增强生成技术提升 Android 恶意软件检测效果

发布时间：2025年06月28日

`LLM应用

这篇论文主要探讨了如何将大型语言模型（LLM）应用于恶意软件检测中。尽管提到了检索增强生成（RAG）作为缓解LLM幻觉问题的方法，但论文的核心贡献在于将LLM和RAG技术应用于恶意软件检测任务，属于LLM的应用领域。因此，分类为LLM应用。` `网络安全` `人工智能`

> Enhancing Android Malware Detection with Retrieval-Augmented Generation

# 摘要

> Android应用的广泛应用使其成为网络攻击的首要目标，显著增加了威胁用户隐私、安全及设备功能的恶意软件风险。因此，有效的恶意软件检测至关重要。目前，静态分析、动态分析和机器学习是常用的检测方法。本研究专注于基于机器学习的静态特征分析方法。我们首先收集了良性与恶意APK的样本集，并通过静态分析提取代码结构、权限及清单文件内容等特征，无需运行应用。与仅依赖原始静态特征不同，我们的系统利用大型语言模型（LLM）生成APK的高层次功能描述。为缓解LLM已知的幻觉问题，我们集成了检索增强生成（RAG），使LLM能够基于相关上下文生成输出。通过精心设计的提示词，我们引导LLM生成连贯的功能摘要，随后采用基于Transformer的模型进行分析，相较于传统基于特征的方法，显著提升了恶意软件检测的准确性。

> The widespread use of Android applications has made them a prime target for cyberattacks, significantly increasing the risk of malware that threatens user privacy, security, and device functionality. Effective malware detection is thus critical, with static analysis, dynamic analysis, and Machine Learning being widely used approaches. In this work, we focus on a Machine Learning-based method utilizing static features. We first compiled a dataset of benign and malicious APKs and performed static analysis to extract features such as code structure, permissions, and manifest file content, without executing the apps. Instead of relying solely on raw static features, our system uses an LLM to generate high-level functional descriptions of APKs. To mitigate hallucinations, which are a known vulnerability of LLM, we integrated Retrieval-Augmented Generation (RAG), enabling the LLM to ground its output in relevant context. Using carefully designed prompts, we guide the LLM to produce coherent function summaries, which are then analyzed using a transformer-based model, improving detection accuracy over conventional feature-based methods for malware detection.

[Arxiv](https://arxiv.org/abs/2506.22750)