# TraceRAG：基于大型语言模型（LLM）的可解释安卓恶意软件检测与行为分析框架

发布时间：2025年09月10日

`RAG` `基础理论`

> TraceRAG: A LLM-Based Framework for Explainable Android Malware Detection and Behavior Analysis

# 摘要

> 恶意Android应用的复杂规避手段，加之其行为语义的复杂性，使得攻击者能将恶意逻辑巧妙隐藏于合法功能中，凸显了构建强大且深入分析框架的迫切需求。然而，传统分析技术往往难以挖掘深层隐藏行为，也无法为检测结果提供通俗易懂的解释。受大型语言模型（LLMs）发展的启发，我们提出了TraceRAG——一个检索增强生成（RAG）框架，它连接自然语言查询与Java代码，实现可解释的恶意软件检测与分析。首先，TraceRAG生成方法级代码片段的摘要，并将其索引至向量数据库。查询时，聚焦行为的问题会检索语义最相关的片段，以便深入检查。最后，基于多轮分析结果，TraceRAG生成人类可读的报告，清晰呈现已识别的恶意行为及其对应的代码实现。实验结果表明，结合更新的VirusTotal（VT）扫描与人工验证，我们的方法恶意软件检测准确率达96%，行为识别准确率达83.81%。此外，专家评估证实了TraceRAG生成报告的实际应用价值。

> Sophisticated evasion tactics in malicious Android applications, combined with their intricate behavioral semantics, enable attackers to conceal malicious logic within legitimate functions, underscoring the critical need for robust and in-depth analysis frameworks. However, traditional analysis techniques often fail to recover deeply hidden behaviors or provide human-readable justifications for their decisions. Inspired by advances in large language models (LLMs), we introduce TraceRAG, a retrieval-augmented generation (RAG) framework that bridges natural language queries and Java code to deliver explainable malware detection and analysis. First, TraceRAG generates summaries of method-level code snippets, which are indexed in a vector database. At query time, behavior-focused questions retrieve the most semantically relevant snippets for deeper inspection. Finally, based on the multi-turn analysis results, TraceRAG produces human-readable reports that present the identified malicious behaviors and their corresponding code implementations. Experimental results demonstrate that our method achieves 96\% malware detection accuracy and 83.81\% behavior identification accuracy based on updated VirusTotal (VT) scans and manual verification. Furthermore, expert evaluation confirms the practical utility of the reports generated by TraceRAG.

[Arxiv](https://arxiv.org/abs/2509.08865)