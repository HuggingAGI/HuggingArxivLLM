# 代码即验证：借助LLMs将BLE应用逻辑转化为形式化模型以检测漏洞

发布时间：2025年09月11日

`LLM应用` `基础理论`

> What You Code Is What We Prove: Translating BLE App Logic into Formal Models with LLMs for Vulnerability Detection

# 摘要

> 蓝牙低功耗（BLE）应用层的安全漏洞问题日益突出，原因在于开发人员常忽略加密、认证和新鲜性等关键防护措施的实现。尽管形式化验证为检查这些属性提供了规范方法，但构建形式化模型的手动工作使其难以应用于大规模分析。本文提出了一个关键见解：BLE应用安全分析可重新定义为语义翻译问题，即从实际代码到形式化模型的转换。我们利用大型语言模型（LLMs）并非直接检测漏洞，而是将其作为转换器，把BLE特定代码转换为可由ProVerif等工具验证的过程模型。我们在VerifiaBLE系统中实现了这一想法，该系统结合静态分析、提示引导的LLM翻译和符号验证，以检查三个核心安全特性：加密、随机性和认证。在对1050个Android BLE应用的测试中，VerifiaBLE发现了系统性缺陷：仅10.2%的应用实现了全部三种保护，而53.9%的应用完全未实施这些保护。我们的研究表明，将LLMs用作结构化转换器能够降低形式化方法的使用门槛，从而在安全关键领域实现可扩展的验证。

> The application layer of Bluetooth Low Energy (BLE) is a growing source of security vulnerabilities, as developers often neglect to implement critical protections such as encryption, authentication, and freshness. While formal verification offers a principled way to check these properties, the manual effort of constructing formal models makes it impractical for large-scale analysis. This paper introduces a key insight: BLE application security analysis can be reframed as a semantic translation problem, i.e., from real-world code to formal models. We leverage large language models (LLMs) not to directly detect vulnerabilities, but to serve as translators that convert BLE-specific code into process models verifiable by tools like ProVerif. We implement this idea in VerifiaBLE, a system that combines static analysis, prompt-guided LLM translation, and symbolic verification to check three core security features: encryption, randomness, and authentication. Applied to 1,050 Android BLE apps, VerifiaBLE uncovers systemic weaknesses: only 10.2\% of apps implement all three protections, while 53.9\% omit them entirely. Our work demonstrates that using LLMs as structured translators can lower the barrier to formal methods, unlocking scalable verification across security-critical domains.

[Arxiv](https://arxiv.org/abs/2509.09291)