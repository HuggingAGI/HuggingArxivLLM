# PatchSeeker：利用LLM生成的提交和嵌入将NVD记录映射至对应的漏洞修复提交

发布时间：2025年09月09日

`LLM应用` `工业与制造`

> PatchSeeker: Mapping NVD Records to their Vulnerability-fixing Commits with LLM Generated Commits and Embeddings

# 摘要

> 软件漏洞已成为现代软件生态系统的重大隐患。国家漏洞数据库（NVD）虽是记录漏洞的权威平台，却常缺失与漏洞修复提交（VFCs）的直接关联。VFCs蕴含精确的代码变更信息，可为漏洞定位、补丁分析及数据集构建提供关键支持，因此实现NVD记录与真实VFCs的自动映射至关重要。现有方法依赖稀疏且噪声较大的提交消息，难以捕捉漏洞描述中的深层语义，存在明显局限。为此，我们提出全新方法PatchSeeker，它借助大型语言模型在漏洞描述与VFCs间构建丰富的语义关联。该方法从NVD描述中生成嵌入向量，并针对简短或信息匮乏的提交消息合成详细摘要以增强语义表达。这些生成消息充当“语义桥梁”，有效弥合了自然语言报告与底层代码变更间的信息鸿沟。在基准数据集上，PatchSeeker的平均倒数排名（MRR）和前10召回率（Recall@10）分别比当前最优基线方法Prospector高出59.3%和27.9%。对近期CVE的扩展测试进一步验证了其有效性。消融实验显示，提交消息生成方法与骨干LLM的选型均对PatchSeeker的性能提升起到积极作用。最后，我们探讨了方法的局限性与开放挑战，为后续研究方向提供参考。

> Software vulnerabilities pose serious risks to modern software ecosystems. While the National Vulnerability Database (NVD) is the authoritative source for cataloging these vulnerabilities, it often lacks explicit links to the corresponding Vulnerability-Fixing Commits (VFCs). VFCs encode precise code changes, enabling vulnerability localization, patch analysis, and dataset construction. Automatically mapping NVD records to their true VFCs is therefore critical. Existing approaches have limitations as they rely on sparse, often noisy commit messages and fail to capture the deep semantics in the vulnerability descriptions. To address this gap, we introduce PatchSeeker, a novel method that leverages large language models to create rich semantic links between vulnerability descriptions and their VFCs. PatchSeeker generates embeddings from NVD descriptions and enhances commit messages by synthesizing detailed summaries for those that are short or uninformative. These generated messages act as a semantic bridge, effectively closing the information gap between natural language reports and low-level code changes. Our approach PatchSeeker achieves 59.3% higher MRR and 27.9% higher Recall@10 than the best-performing baseline, Prospector, on the benchmark dataset. The extended evaluation on recent CVEs further confirms PatchSeeker's effectiveness. Ablation study shows that both the commit message generation method and the selection of backbone LLMs make a positive contribution to PatchSeeker. We also discuss limitations and open challenges to guide future work.

[Arxiv](https://arxiv.org/abs/2509.07540)