# 不确定性驱动的分层采样：基于时间序列更新检索的非平衡持续恶意软件检测

发布时间：2025年09月09日

`其他` `基础理论`

> Uncertainty-Driven Hierarchical Sampling for Unbalanced Continual Malware Detection with Time-Series Update-Based Retrieval

# 摘要

> Android恶意软件检测始终面临着长期概念漂移和类别不平衡带来的挑战，这是由于恶意行为的不断演变和使用模式的变化会动态重塑特征分布。尽管持续学习（CL）能够缓解漂移问题，但现有的基于回放的方法存在固有偏差。具体来说，这些方法依赖分类器的不确定性来选择样本，会不成比例地优先考虑占主导的良性类别，从而导致过拟合，并降低对不断演变的恶意软件的泛化能力。为解决这些局限性，我们提出了一种新颖的不确定性引导持续学习（CL）框架。首先，我们引入了一种分层平衡采样器，它采用双阶段不确定性策略，动态平衡良性和恶意样本，同时在每个类别中选择高信息、高不确定性的实例。这种机制确保了回放数据和增量数据的类别平衡，进而增强了对新兴威胁的适应能力。其次，我们通过向量检索机制对该框架进行增强，该机制利用历史恶意软件嵌入，通过基于相似性的检索来识别演变的变体，从而补充分类器的更新。大量实验表明，在严格的低标签条件下（每阶段50个标签），我们的框架显著优于当前最先进的方法。该框架实现了92.95%的真阳性率（TPR）和94.26%的平均准确率（mACC），验证了其在可持续Android恶意软件检测中的有效性。

> Android malware detection continues to face persistent challenges stemming from long-term concept drift and class imbalance, as evolving malicious behaviors and shifting usage patterns dynamically reshape feature distributions. Although continual learning (CL) mitigates drift, existing replay-based methods suffer from inherent bias. Specifically, their reliance on classifier uncertainty for sample selection disproportionately prioritizes the dominant benign class, causing overfitting and reduced generalization to evolving malware. To address these limitations, we propose a novel uncertainty-guided CL framework. First, we introduce a hierarchical balanced sampler that employs a dual-phase uncertainty strategy to dynamically balance benign and malicious samples while simultaneously selecting high-information, high-uncertainty instances within each class. This mechanism ensures class equilibrium across both replay and incremental data, thereby enhancing adaptability to emerging threats. Second, we augment the framework with a vector retrieval mechanism that exploits historical malware embeddings to identify evolved variants via similarity-based retrieval, thereby complementing classifier updates. Extensive experiments demonstrate that our framework significantly outperforms state-of-the-art methods under strict low-label conditions (50 labels per phase). It achieves a true positive rate (TPR) of 92.95\% and a mean accuracy (mACC) of 94.26\%, which validates its efficacy for sustainable Android malware detection.

[Arxiv](https://arxiv.org/abs/2509.07532)