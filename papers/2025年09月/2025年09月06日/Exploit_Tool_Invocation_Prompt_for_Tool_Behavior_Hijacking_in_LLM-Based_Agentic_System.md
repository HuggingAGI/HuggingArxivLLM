# 利用工具调用提示在基于LLM的智能体系统中劫持工具行为

发布时间：2025年09月06日

`Agent` `基础理论`

> Exploit Tool Invocation Prompt for Tool Behavior Hijacking in LLM-Based Agentic System

# 摘要

> 基于大型语言模型（LLM）的智能体系统借助大型语言模型处理用户查询、制定决策并执行外部工具，从而完成聊天机器人、客户服务、软件工程等多个领域的复杂任务。这类系统的核心组件是工具调用提示（TIP），它定义工具交互协议并引导大型语言模型，确保工具使用的安全性与正确性。尽管TIP至关重要，但其安全性却在很大程度上被忽视。本研究对TIP相关安全风险展开调查，发现Cursor、Claude Code等主流基于LLM的系统均存在漏洞，易受远程代码执行（RCE）、拒绝服务（DoS）等攻击。通过系统性TIP利用工作流（TEW），我们演示了如何通过操纵工具调用实现外部工具行为劫持。此外，我们还提出了防御机制，旨在提升基于LLM的智能体系统的TIP安全性。

> LLM-based agentic systems leverage large language models to handle user queries, make decisions, and execute external tools for complex tasks across domains like chatbots, customer service, and software engineering. A critical component of these systems is the Tool Invocation Prompt (TIP), which defines tool interaction protocols and guides LLMs to ensure the security and correctness of tool usage. Despite its importance, TIP security has been largely overlooked. This work investigates TIP-related security risks, revealing that major LLM-based systems like Cursor, Claude Code, and others are vulnerable to attacks such as remote code execution (RCE) and denial of service (DoS). Through a systematic TIP exploitation workflow (TEW), we demonstrate external tool behavior hijacking via manipulated tool invocations. We also propose defense mechanisms to enhance TIP security in LLM-based agentic systems.

[Arxiv](https://arxiv.org/abs/2509.05755)