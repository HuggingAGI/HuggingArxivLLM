# SCALE 项目：打造有序的自然语言注释树，助力软件安全漏洞识别

发布时间：2024年03月27日

`LLM应用` `软件安全` `漏洞检测`

> SCALE: Constructing Structured Natural Language Comment Trees for Software Vulnerability Detection

# 摘要

> 近期，自动化软件漏洞识别技术备受瞩目。预训练模型驱动的方法在漏洞检测上展现出超越其他深度学习方法的卓越性能。然而，这些预训练模型通常在预测阶段以代码序列为输入，可能会遗漏与漏洞相关的结构性信息，主要表现在两个方面。一是它们难以解析那些包含多个操作符和指针等复杂逻辑的代码语句含义。二是它们不易理解多样的代码执行顺序，而这对于精确的漏洞检测极为关键。为解决这些问题，我们设计了一个基于预训练模型的结构化自然语言注释树（SCT）漏洞检测框架，命名为SCALE。该框架通过抽象语法树（ASTs）将代码语句的语义与执行序列相结合，创建了一种新型的结构化自然语言注释树。SCALE主要由三大模块构成：（1）注释树构建模块，通过引入大型语言模型（LLMs）生成注释并整合至ASTs中，以提升模型对代码语句语义的解析能力。（2）结构化自然语言注释树构建模块，通过结合代码语法模板与注释树，显式引入代码执行序列。（3）SCT增强表示模块，将构建好的SCTs整合进来，以便更准确地捕获漏洞模式。

> Recently, there has been a growing interest in automatic software vulnerability detection. Pre-trained model-based approaches have demonstrated superior performance than other Deep Learning (DL)-based approaches in detecting vulnerabilities. However, the existing pre-trained model-based approaches generally employ code sequences as input during prediction, and may ignore vulnerability-related structural information, as reflected in the following two aspects. First, they tend to fail to infer the semantics of the code statements with complex logic such as those containing multiple operators and pointers. Second, they are hard to comprehend various code execution sequences, which is essential for precise vulnerability detection.
  To mitigate the challenges, we propose a Structured Natural Language Comment tree-based vulnerAbiLity dEtection framework based on the pre-trained models, named SCALE. The proposed Structured Natural Language Comment Tree (SCT) integrates the semantics of code statements with code execution sequences based on the Abstract Syntax Trees (ASTs). Specifically, SCALE comprises three main modules: (1) Comment Tree Construction, which aims at enhancing the model's ability to infer the semantics of code statements by first incorporating Large Language Models (LLMs) for comment generation and then adding the comment node to ASTs. (2) Structured Natural Language Comment Tree Construction}, which aims at explicitly involving code execution sequence by combining the code syntax templates with the comment tree. (3) SCT-Enhanced Representation, which finally incorporates the constructed SCTs for well capturing vulnerability patterns.

[Arxiv](https://arxiv.org/abs/2403.19096)