# 将 GPT 与基于代码的相似性检查相结合，实现有效的智能合约漏洞检测

发布时间：2024年12月24日

`LLM应用` `区块链`

> Combining GPT and Code-Based Similarity Checking for Effective Smart Contract Vulnerability Detection

# 摘要

> 随着区块链技术的迅猛发展，智能合约如今在去中心化金融（DeFi）应用中举足轻重。有效的漏洞检测对于保障这些合约免受黑客侵袭、提升安全审计的精准度和效率至关重要。在本文中，我们推出了 SimilarGPT，这是一款针对智能合约的独特漏洞识别工具，它将生成式预训练转换器（GPT）模型与基于代码的相似性检查方法相融合。SimilarGPT 工具的核心概念在于衡量被检测代码与第三方库安全代码之间的相似度。为识别潜在漏洞，我们将大型语言模型（LLMs）的语义理解能力与基于代码的相似性检查技术相结合。我们提议采用拓扑排序优化检测顺序，以增强检测中的逻辑连贯性并降低误报率。通过对智能合约中的代码复用模式加以分析，我们编译和处理海量第三方库代码，构建起全面的参考代码库。接着，我们借助 LLM 对相似代码展开深度剖析，从而识别并阐释代码中的潜在漏洞。实验结果显示，SimilarGPT 在智能合约漏洞检测方面表现卓越，尤其在漏检和减少误报方面优势明显。

> With the rapid growth of blockchain technology, smart contracts are now crucial to Decentralized Finance (DeFi) applications. Effective vulnerability detection is vital for securing these contracts against hackers and enhancing the accuracy and efficiency of security audits. In this paper, we present SimilarGPT, a unique vulnerability identification tool for smart contract, which combines Generative Pretrained Transformer (GPT) models with Code-based similarity checking methods. The main concept of the SimilarGPT tool is to measure the similarity between the code under inspection and the secure code from third-party libraries. To identify potential vulnerabilities, we connect the semantic understanding capability of large language models (LLMs) with Code-based similarity checking techniques. We propose optimizing the detection sequence using topological ordering to enhance logical coherence and reduce false positives during detection. Through analysis of code reuse patterns in smart contracts, we compile and process extensive third-party library code to establish a comprehensive reference codebase. Then, we utilize LLM to conduct an indepth analysis of similar codes to identify and explain potential vulnerabilities in the codes. The experimental findings indicate that SimilarGPT excels in detecting vulnerabilities in smart contracts, particularly in missed detections and minimizing false positives.

[Arxiv](https://arxiv.org/abs/2412.18225)