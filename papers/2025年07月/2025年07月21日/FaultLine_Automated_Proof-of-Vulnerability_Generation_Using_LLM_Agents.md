# FaultLine：基于 LLM 智能体的漏洞证明自动生成系统

发布时间：2025年07月21日

`LLM应用

理由：这篇论文介绍了FaultLine，一个基于LLM的工具，用于生成PoV测试用例，解决软件安全漏洞中的测试问题。它结合了LLM与传统分析方法，属于LLM在具体应用领域的创新使用。` `软件安全` `漏洞管理`

> FaultLine: Automated Proof-of-Vulnerability Generation Using LLM Agents

# 摘要

> 尽管软件安全漏洞威胁严重，但漏洞报告往往缺乏必要的PoV测试，这些测试不仅用于验证修复，还能帮助开发者理解漏洞利用方式。生成PoV测试极具挑战性，需要深入分析程序的控制流和数据流。

我们推出FaultLine，一个基于LLM的自动化PoV测试生成工具。它通过一系列精心设计的推理步骤，结合传统静态和动态分析方法的精髓，实现跨语言的PoV测试生成。具体来说，FaultLine能：
1. 追踪输入从API入口到漏洞所在位置的流动路径
2. 分析输入必须满足的条件以触发漏洞
3. 自动生成PoV测试用例

与CodeAct 2.1等现有工具相比，FaultLine在多语言漏洞数据集上表现优异，成功率为前者的近两倍。这表明分层推理方法能显著提升LLM在漏洞测试生成中的效果，但该领域仍具挑战性。我们公开了工具和数据集，期待推动相关研究的发展。


> Despite the critical threat posed by software security vulnerabilities, reports are often incomplete, lacking the proof-of-vulnerability (PoV) tests needed to validate fixes and prevent regressions. These tests are crucial not only for ensuring patches work, but also for helping developers understand how vulnerabilities can be exploited. Generating PoV tests is a challenging problem, requiring reasoning about the flow of control and data through deeply nested levels of a program.
  We present FaultLine, an LLM agent workflow that uses a set of carefully designed reasoning steps, inspired by aspects of traditional static and dynamic program analysis, to automatically generate PoV test cases. Given a software project with an accompanying vulnerability report, FaultLine 1) traces the flow of an input from an externally accessible API ("source") to the "sink" corresponding to the vulnerability, 2) reasons about the conditions that an input must satisfy in order to traverse the branch conditions encountered along the flow, and 3) uses this reasoning to generate a PoV test case in a feedback-driven loop. FaultLine does not use language-specific static or dynamic analysis components, which enables it to be used across programming languages.
  To evaluate FaultLine, we collate a challenging multi-lingual dataset of 100 known vulnerabilities in Java, C and C++ projects. On this dataset, FaultLine is able to generate PoV tests for 16 projects, compared to just 9 for CodeAct 2.1, a popular state-of-the-art open-source agentic framework. Thus, FaultLine represents a 77% relative improvement over the state of the art. Our findings suggest that hierarchical reasoning can enhance the performance of LLM agents on PoV test generation, but the problem in general remains challenging. We make our code and dataset publicly available in the hope that it will spur further research in this area.

[Arxiv](https://arxiv.org/abs/2507.15241)