# 基于LLMs的显式漏洞生成：超越对抗攻击的研究

发布时间：2025年07月14日

`LLM应用` `代码生成`

> Explicit Vulnerability Generation with LLMs: An Investigation Beyond Adversarial Attacks

# 摘要

> 大型语言模型（LLMs）正日益成为代码助手的得力工具，但它们在生成不安全代码时的行为仍有许多未知。以往研究多关注于无意漏洞或对抗性提示技术，而本研究聚焦一个更直接的威胁场景：开源LLMs在直接或间接提示下生成易受攻击代码。我们设计了双重实验方案：（1）动态提示，通过结构化模板系统性地调整漏洞类型、用户角色和直接程度；（2）逆向提示，从真实漏洞代码样本中提取提示，以评估漏洞再现的准确性。我们采用ESBMC静态分析，对Qwen2、Mistral和Gemma三个开源7B参数模型进行了评估，重点关注漏洞存在性及生成漏洞类型的准确性。结果显示，所有模型均频繁生成易受攻击的代码，其中Qwen2表现最佳。用户角色显著影响成功率，学生角色较职业角色更易生成漏洞代码，而直接提示略胜一筹。漏洞再现与循环复杂度呈现倒U型关系，在中等范围内达到峰值。我们的研究揭示了开源模型安全机制的局限性，特别是在看似无害的教育请求场景下。


> Large Language Models (LLMs) are increasingly used as code assistants, yet their behavior when explicitly asked to generate insecure code remains poorly understood. While prior research has focused on unintended vulnerabilities or adversarial prompting techniques, this study examines a more direct threat scenario: open-source LLMs generating vulnerable code when prompted either directly or indirectly. We propose a dual experimental design: (1) Dynamic Prompting, which systematically varies vulnerability type, user persona, and directness across structured templates; and (2) Reverse Prompting, which derives prompts from real vulnerable code samples to assess vulnerability reproduction accuracy. We evaluate three open-source 7B-parameter models (Qwen2, Mistral, and Gemma) using ESBMC static analysis to assess both the presence of vulnerabilities and the correctness of the generated vulnerability type. Results show all models frequently produce vulnerable outputs, with Qwen2 achieving highest correctness rates. User persona significantly affects success, where student personas achieved higher vulnerability rates than professional roles, while direct prompts were marginally more effective. Vulnerability reproduction followed an inverted-U pattern with cyclomatic complexity, peaking at moderate ranges. Our findings expose limitations of safety mechanisms in open-source models, particularly for seemingly benign educational requests.

[Arxiv](https://arxiv.org/abs/2507.10054)