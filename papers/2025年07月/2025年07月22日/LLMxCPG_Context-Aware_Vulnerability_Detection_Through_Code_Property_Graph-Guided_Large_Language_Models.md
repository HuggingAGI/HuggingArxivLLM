# LLMxCPG：通过代码属性图引导的大语言模型实现上下文感知漏洞检测

发布时间：2025年07月22日

`LLM应用

这篇论文将大型语言模型（LLM）应用于软件漏洞检测，提出了一种结合代码属性图（CPG）的新框架，展示了其在实际应用中的有效性。因此，它属于LLM应用类别。` `信息安全` `软件工程`

> LLMxCPG: Context-Aware Vulnerability Detection Through Code Property Graph-Guided Large Language Models

# 摘要

> 软件漏洞始终是信息安全领域的一大难题，仅2024年单年就有超过25,000个新漏洞被收录到CVE数据库中。尽管基于深度学习的方法在漏洞检测方面展现出潜力，但近期研究揭示了这些方法在准确性和鲁棒性方面的重大局限：在经过严格验证的数据集上，准确率下降高达45%，而在面对简单的代码修改时，性能会出现显著下降。本文提出了一种名为LLMxCPG的全新框架，该框架通过将代码属性图（CPG）与大型语言模型（LLM）相结合，实现了更稳健的漏洞检测。我们的基于CPG的切片构造技术在保留与漏洞相关上下文的同时，将代码规模缩减了67.84%至90.93%。我们方法能够提供更简洁、准确的代码片段表示，从而支持对更大代码段的分析，包括整个项目。这种简洁的表示是我们的方法检测能力提升的关键因素，因为它能够识别跨越多个函数的漏洞。实证评估显示，LLMxCPG在经过验证的数据集上表现出色，F1值较现有最优基线提升了15%-40%。此外，LLMxCPG在函数级别和多函数代码库上均保持了高性能，同时在面对各种语法代码修改时，展现了强大的检测效能。

> Software vulnerabilities present a persistent security challenge, with over 25,000 new vulnerabilities reported in the Common Vulnerabilities and Exposures (CVE) database in 2024 alone. While deep learning based approaches show promise for vulnerability detection, recent studies reveal critical limitations in terms of accuracy and robustness: accuracy drops by up to 45% on rigorously verified datasets, and performance degrades significantly under simple code modifications. This paper presents LLMxCPG, a novel framework integrating Code Property Graphs (CPG) with Large Language Models (LLM) for robust vulnerability detection. Our CPG-based slice construction technique reduces code size by 67.84 to 90.93% while preserving vulnerability-relevant context. Our approach's ability to provide a more concise and accurate representation of code snippets enables the analysis of larger code segments, including entire projects. This concise representation is a key factor behind the improved detection capabilities of our method, as it can now identify vulnerabilities that span multiple functions. Empirical evaluation demonstrates LLMxCPG's effectiveness across verified datasets, achieving 15-40% improvements in F1-score over state-of-the-art baselines. Moreover, LLMxCPG maintains high performance across function-level and multi-function codebases while exhibiting robust detection efficacy under various syntactic code modifications.

[Arxiv](https://arxiv.org/abs/2507.16585)