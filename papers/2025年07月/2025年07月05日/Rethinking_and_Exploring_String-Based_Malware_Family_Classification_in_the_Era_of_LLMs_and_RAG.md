# # 重新审视与探索基于字符串的恶意软件家族分类在LLMs与RAG技术背景下的研究

发布时间：2025年07月05日

`LLM应用` `网络安全` `人工智能`

> Rethinking and Exploring String-Based Malware Family Classification in the Era of LLMs and RAG

# 摘要

> 恶意软件家族分类（MFC）旨在识别恶意软件样本所属的细粒度家族（如 GuLoader 或 BitRAT），不同于仅预测“是”或“否”的恶意软件检测或样本分类。准确的家族识别能够显著提升 VirusTotal 和 MalwareBazaar 等 crowdsourced 恶意软件分析平台上的自动样本标注和理解能力，这些平台每天产生海量数据。本文探索并评估了在大型语言模型（LLMs）和检索增强生成（RAG）新时代中，使用传统二进制字符串特征进行 MFC 的可行性。具体而言，我们研究了如何以类似 RAG 的方式利用家族特定字符串（FSS）特征来促进 MFC。为此，我们构建了一个包含 67 个恶意软件家族 4347 个样本的评估框架，提取并分析了超过 2500 万条字符串，并进行了详细消融研究，以评估四个主要模块中不同设计选择的影响。

> Malware Family Classification (MFC) aims to identify the fine-grained family (e.g., GuLoader or BitRAT) to which a potential malware sample belongs, in contrast to malware detection or sample classification that predicts only an Yes/No. Accurate family identification can greatly facilitate automated sample labeling and understanding on crowdsourced malware analysis platforms such as VirusTotal and MalwareBazaar, which generate vast amounts of data daily. In this paper, we explore and assess the feasibility of using traditional binary string features for MFC in the new era of large language models (LLMs) and Retrieval-Augmented Generation (RAG). Specifically, we investigate how Family-Specific String (FSS) features could be utilized in a manner similar to RAG to facilitate MFC. To this end, we develop a curated evaluation framework covering 4,347 samples from 67 malware families, extract and analyze over 25 million strings, and conduct detailed ablation studies to assess the impact of different design choices in four major modules.

[Arxiv](https://arxiv.org/abs/2507.04055)