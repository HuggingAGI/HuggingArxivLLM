# 采用模型上下文协议的LLMs存在重大安全漏洞——MCP安全审核

发布时间：2025年04月02日

`LLM应用` `人工智能` `网络安全`

> MCP Safety Audit: LLMs with the Model Context Protocol Allow Major Security Exploits

# 摘要

> 为了降低开发成本并实现任意生成式AI应用组件的无缝集成，模型上下文协议（MCP）（Anthropic，2024）近期发布并被广泛采用。MCP是一个开放协议，标准化了对大型语言模型（LLMs）、数据源和智能工具的API调用。通过连接多个MCP服务器，每个服务器都定义了一组工具、资源和提示，用户能够定义完全由LLMs驱动的自动化工作流。然而，我们发现当前MCP设计对终端用户存在多种安全风险。特别是，我们演示了行业领先的LLMs可能被迫使用MCP工具通过各种攻击（如恶意代码执行、远程访问控制和凭证窃取）来破坏AI开发者的系统。为了主动缓解这些及相关攻击，我们引入了一个安全审计工具MCPSafetyScanner，这是首个用于评估任意MCP服务器安全性的智能工具。MCPSafetyScanner利用多个代理来（a）根据MCP服务器的工具和资源自动确定对抗样本；（b）基于这些样本搜索相关漏洞和补救措施；（c）生成一份详细说明所有发现的安全报告。我们的工作突显了通用智能工作流的安全问题，同时提供了一个主动工具来审计MCP服务器的安全性并在部署前修复检测到的漏洞。

    描述的MCP服务器审计工具MCPSafetyScanner可在以下链接免费获取：https://github.com/leidosinc/McpSafetyScanner

> To reduce development overhead and enable seamless integration between potential components comprising any given generative AI application, the Model Context Protocol (MCP) (Anthropic, 2024) has recently been released and subsequently widely adopted. The MCP is an open protocol that standardizes API calls to large language models (LLMs), data sources, and agentic tools. By connecting multiple MCP servers, each defined with a set of tools, resources, and prompts, users are able to define automated workflows fully driven by LLMs. However, we show that the current MCP design carries a wide range of security risks for end users. In particular, we demonstrate that industry-leading LLMs may be coerced into using MCP tools to compromise an AI developer's system through various attacks, such as malicious code execution, remote access control, and credential theft. To proactively mitigate these and related attacks, we introduce a safety auditing tool, MCPSafetyScanner, the first agentic tool to assess the security of an arbitrary MCP server. MCPScanner uses several agents to (a) automatically determine adversarial samples given an MCP server's tools and resources; (b) search for related vulnerabilities and remediations based on those samples; and (c) generate a security report detailing all findings. Our work highlights serious security issues with general-purpose agentic workflows while also providing a proactive tool to audit MCP server safety and address detected vulnerabilities before deployment.
  The described MCP server auditing tool, MCPSafetyScanner, is freely available at: https://github.com/leidosinc/McpSafetyScanner

[Arxiv](https://arxiv.org/abs/2504.03767)