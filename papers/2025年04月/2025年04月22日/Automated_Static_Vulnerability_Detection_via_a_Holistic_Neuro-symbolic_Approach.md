# 通过整体神经符号方法实现自动化静态漏洞检测

发布时间：2025年04月22日

`LLM应用` `软件工程` `人工智能`

> Automated Static Vulnerability Detection via a Holistic Neuro-symbolic Approach

# 摘要

> 静态漏洞检测是一项耗时费力的挑战性任务，传统方法需要大量人工参与，例如手动整理漏洞模式。现有的经典程序分析方法或基于大型语言模型（LLM）的技术，都未能实现漏洞模式的全自动精准生成。本文提出了一种全新的综合性神经符号框架——MoCQ，它巧妙结合了LLMs与经典静态分析的各自优势，实现了高效可扩展的漏洞检测。MoCQ的核心创新在于，它利用LLM自动提取漏洞模式并生成检测查询，再通过静态分析对这些查询进行迭代优化，最终用于大规模代码库的漏洞挖掘。我们在两种编程语言上针对七类漏洞对MoCQ进行了全面评估。结果显示，MoCQ生成的查询成功发现了至少12个被专家忽视的漏洞模式。在真实数据集上，MoCQ的检测效果与专家编写的查询相当。更重要的是，MoCQ在实际应用中发现了七个此前未被发现的安全漏洞，充分证明了其实际应用价值。我们已负责任地将这些漏洞报告给了相关开发者。

> Static vulnerability detection is still a challenging problem and demands excessive human efforts, e.g., manual curation of good vulnerability patterns. None of prior works, including classic program analysis or Large Language Model (LLM)-based approaches, have fully automated such vulnerability pattern generations with reasonable detection accuracy. In this paper, we design and implement, MoCQ, a novel holistic neuro-symbolic framework that combines the complementary strengths of LLMs and classical static analysis to enable scalable vulnerability detection. The key insight is that MoCQ leverages an LLM to automatically extract vulnerability patterns and translate them into detection queries, and then on static analysis to refine such queries in a feedback loop and eventually execute them for analyzing large codebases and mining vulnerabilities. We evaluate MoCQ on seven types of vulnerabilities spanning two programming languages. We found MoCQ-generated queries uncovered at least 12 patterns that were missed by experts. On a ground truth dataset, MoCQ achieved comparable precision and recall compared to expert-crafted queries. Moreover, MoCQ has identified seven previously unknown vulnerabilities in real-world applications, demonstrating its practical effectiveness. We have responsibly disclosed them to the corresponding developers.

[Arxiv](https://arxiv.org/abs/2504.16057)