# 文生图模型的提示模板窃取漏洞：基于差分进化的方法

发布时间：2025年02月20日

`LLM应用` `知识产权` `计算机安全`

> Vulnerability of Text-to-Image Models to Prompt Template Stealing: A Differential Evolution Approach

# 摘要

> 近年来，提示交易已成为重要的知识产权问题。供应商通过展示样本图像吸引用户，随后销售可生成类似图像的提示模板。本研究发现了一个关键安全漏洞：仅需少量样本图像，攻击者即可窃取提示模板。为研究这一威胁，我们推出了Prism——一个包含50个模板和450张图像的提示窃取基准数据集，分为简单和困难两个难度等级。为识别视觉语言模型（VLMs）对提示窃取的漏洞，我们提出了EvoStealer——一种无需模型微调的创新模板窃取方法，通过差分进化算法实现。该系统首先基于预定义模式，使用多模态大型语言模型（MLLMs）初始化种群集，然后通过MLLMs迭代生成优化的子代。在进化过程中，EvoStealer识别子代中的共同特征，从而推导出通用模板。我们在开源（INTERNVL2-26B）和闭源模型（GPT-4o和GPT-4o-mini）上的全面评估表明，EvoStealer窃取的模板能够高度还原原始图像，并有效推广到其他主题。与基线方法相比，EvoStealer的性能显著提升，平均提升幅度超过10%。此外，我们的成本分析显示，EvoStealer以极低的计算开销实现了模板窃取。我们的代码和数据集可在https://github.com/whitepagewu/evostealer获取。

> Prompt trading has emerged as a significant intellectual property concern in recent years, where vendors entice users by showcasing sample images before selling prompt templates that can generate similar images. This work investigates a critical security vulnerability: attackers can steal prompt templates using only a limited number of sample images. To investigate this threat, we introduce Prism, a prompt-stealing benchmark consisting of 50 templates and 450 images, organized into Easy and Hard difficulty levels. To identify the vulnerabity of VLMs to prompt stealing, we propose EvoStealer, a novel template stealing method that operates without model fine-tuning by leveraging differential evolution algorithms. The system first initializes population sets using multimodal large language models (MLLMs) based on predefined patterns, then iteratively generates enhanced offspring through MLLMs. During evolution, EvoStealer identifies common features across offspring to derive generalized templates. Our comprehensive evaluation conducted across open-source (INTERNVL2-26B) and closed-source models (GPT-4o and GPT-4o-mini) demonstrates that EvoStealer's stolen templates can reproduce images highly similar to originals and effectively generalize to other subjects, significantly outperforming baseline methods with an average improvement of over 10%. Moreover, our cost analysis reveals that EvoStealer achieves template stealing with negligible computational expenses. Our code and dataset are available at https://github.com/whitepagewu/evostealer.

[Arxiv](https://arxiv.org/abs/2502.14285)